%{
Ref: Mills, K. C., Karagadde, S., Lee, P. D., Yuan, L., & Shahbazian, F. (2016). Calculation of physical properties for use in models of continuous casting process-Part 1: Mould slags. ISIJ International, 56(2). https://doi.org/10.2355/isijinternational.ISIJINT-2015-364
Ref: Sridhar, S., K. C. Mills, O. D. C. Afrange, H. P. LÃ¶rz, and R. Carli. "Break temperatures of mould fluxes and their relevance to continuous casting." Ironmaking & steelmaking 27, no. 3 (2000): 238-242.

Output is in Kelvin

Many oxides are missing from this model
%}




function [T_break,T_crit,T_liq,T_g] = Temps(T,XSiO2,XTiO2,XAl2O3,XCr2O3,XFeO,XMgO,XMnO,XCaO,XNa2O,XK2O,XLi2O,XCaF2,XZrO2,XB2O3,XCrO,XNiO,XFe2O3,XBaO,XSrO)
%                SiO2, TiO2, Al2O3, Cr2O3,   FeO,   MgO, MnO,   CaO, Na2O,  K2O, Li2O, CaF2,  ZrO2, B2O3, CrO,  NiO, Fe2O3,   BaO,   SrO
MoleWeight =    [  60, 79.9, 101.9,   152, 71.85,  40.3,  71, 56.08,   62, 94.2, 29.8,   78, 123.2, 69.8,  68, 74.7, 159.7, 153.3, 103.6]';
MoleFraction = [XSiO2,XTiO2,XAl2O3,XCr2O3,  XFeO,  XMgO,XMnO,  XCaO,XNa2O, XK2O,XLi2O,XCaF2, XZrO2,XB2O3,XCrO,XNiO, XFe2O3,  XBaO,  XSrO]';
TotalMass = sum(MoleWeight.*MoleFraction);

% T_break
mSiO2 = MoleWeight(1)*XSiO2/TotalMass;
mCaO = MoleWeight(8)*XCaO/TotalMass;
mAl2O3 = MoleWeight(3)*XAl2O3/TotalMass;
mMgO = MoleWeight(6)*XMgO/TotalMass;
mNa2O = MoleWeight(9)*XNa2O/TotalMass;
mK2O = MoleWeight(10)*XK2O/TotalMass;
mLi2O = MoleWeight(11)*XLi2O/TotalMass;
mF = MoleWeight(12)*XCaF2/TotalMass;
mFeO = MoleWeight(5)*XFeO/TotalMass;
mMnO = MoleWeight(7)*XMnO/TotalMass;

T_break = 1393 - 3.3*mSiO2 + 8.65*mCaO -8.45*mAl2O3-17.1*mMgO-3.2*mNa2O-2.2*mK2O-6.6*mLi2O-6.47*mF-18.4*mFeO-3.2*mMnO ;

%T_Crit
T_crit = 2158.5...
    -XSiO2*914 ...    %SiO2
    -XTiO2*1501 ...   %TiO2
    -XAl2O3*5.67 ...   %Al2O3
    ...-XCr2O3*2198 ...   %Cr2O3 No mention of this in ref
    -XFeO*522 ...    %FeO
    -XMgO*855 ...    %MgO
    -XMnO*761 ...    %MnO
    -XCaO*1109 ...   %CaO
    -XNa2O*1820 ...   %Na2O
    -XK2O*1835 ...    %K2O
    -XLi2O*2838 ...   %Li2O
    -XSrO*1323 ...    %SrO
    -XBaO*1450 ...    %BaO
    -XCaF2*1500 ...   %CaF2
    -XZrO2*47.6 ...   %ZrO2
    -XFe2O3*2159 ;    %Fe2O3

%T_liq
T_liq = 958 ...
    +656.9*XSiO2...
    +1040.7*XCaO...
    +1343.2*XAl2O3...
    +1090.5*XMgO...
    +137*XNa2O...
    -668*XK2O...
    +408.7*XLi2O...
    +522*XFeO...
    +760.9*XMnO...
    +1022*XCrO...
    +794*XFe2O3...
    +2198*XCr2O3...
    -532*XCaF2...
    +844*XTiO2...
    -12.6*XB2O3...
    +1207*XBaO...
    +1768*XSrO...
    +2234*XZrO2 ;

%T_g
% T_g = 910.1...
%     -102.2*XSiO2...
%     +414.5*XCaO...
%     +15.1*XAl2O3...
%     -388.5*XNa2O...
%     -394.9*XLi2O...
%     -342.4*XK2O...
%     -35.4*XMgO...
%     -3541*XCaF2...
%     +547*XMnO...
%     +1634*XFeO...
%     -53.5*XSrO...
%     -318.4*XBaO...
%     +96.4*TiO2...
%     +4.14*XZrO2...
%     -1782*XFe2O3;

T_g = 633+273.1 ...
    -330*XSiO2...
    +190*XCaO...
    +445*XAl2O3...
    -449*(XNa2O+XK2O)...
    -11*XMgO...
    +154*XCaF2...
    -309*XMnO...
    -1391*XFeO ;
    

end
