%{
Ref: 
Notes: 

Output in J/(K-mol)
%}

function [Cp_NIST, Del_H_NIST] = Cp_NIST(T,XSiO2,XTiO2,XAl2O3,XCr2O3,XFeO,XMgO,XMnO,XCaO,XNa2O,XK2O,XLi2O,XCaF2,XZrO2,XB2O3,XCrO,XNiO,XFe2O3,XBaO,XSrO)

feed_mol_frac = [XSiO2,XTiO2,XAl2O3,XCr2O3,XFeO,XMgO,XMnO,XCaO,XNa2O,XK2O,XLi2O,XCaF2,XZrO2,XB2O3,XCrO,XNiO,XFe2O3,XBaO,XSrO]';
[~,~,T_Liq,~] = Temps(T,XSiO2,XTiO2,XAl2O3,XCr2O3,XFeO,XMgO,XMnO,XCaO,XNa2O,XK2O,XLi2O,XCaF2,XZrO2,XB2O3,XCrO,XNiO,XFe2O3,XBaO,XSrO);

if T>T_Liq %Use data for liquid
%Data MnO and NiO from Smithells (8-46) No data found for CrO
% h matrix is the enthalpy of formation
         %  [*SiO2,       *TiO2,   *Al2O3,   *Cr2O3,     *FeO,     *MgO,     MnO,     *CaO,     *Na2O,     *K2O,      *Li2O,        *CaF2,    *ZrO2,    *B2O3,CrO,      NiO,    Fe2O3,         BaO,         SrO]   
    a = [   85.772,    100.4160,  192.464,  156.900,  68.1992,  66.9440, 46.5065, 62.76000,  104.6000, 72.55098,   100.4160,     99.91434, 87.86370,  111.569,  0, -20.8881, 110.9362,     66.9440,     66.9440]';
    b = [-0.000016, 5.991573e-8,  9.52e-8, 0.000169, -4.5e-10, 0.000000,   8.121, 4.629e-7, 9.909e-10, 41.39097,  -0.000026, -6.798332e-9, 0.000141, 23.17410,  0, 157.3099, 32.04714,    0.000002, 1.160633e-7]';
    c = [ 0.000004,-1.796728e-8,-2.858e-8,-0.000035,1.195e-10, 0.000000,       0,-1.092e-7,-6.022e-10, -0.28497,   0.000007,  2.346242e-9,-0.000027,-10.32210,  0,        0,-9.192333,-3.301011e-7,-2.612763e-8]'; 
    d = [-3.809e-7, 1.839876e-9, 2.929e-9, 0.000003,-1.06e-11, 0.000000,       0, 8.966e-9, 1.113e-10, 0.218564,-7.07027e-7,-2.687513e-10, 0.000002, 1.533191,  0,        0, 0.901506, 1.464401e-8, 2.031095e-9]'; 
    e = [  -1.7e-5, 3.592186e-8, 5.599e-8, 0.000369,-3.09e-10, 0.000000,-0.36837, 6.504e-7, 2.362e-11, 0.066026,  -0.000023, -2.188241e-9, 0.000393, 3.539531,  0,   1.6284, 5.433677,    0.000004, 1.773461e-7]'; 
    f = [  -952.87,   -955.6758, -1757.71,-1111.580,-281.4326,-580.9944,       0, -591.806, -404.0296,-386.1610,   -593.572,    -1229.807, -1067.80,  -1290.9,  0,        0,-843.1471,   -525.6580,   -554.8528]'; 
    g = [  113.344,    145.6358, 177.1008,  252.717, 137.8377, 93.74712,       0, 116.8909,  218.1902, 170.5629,    151.759,     187.1574,  153.041,  188.081,  0,        0, 228.3548,    156.3120,    137.4013]'; 
    h = [ -902.661,   -894.0539, -1620.56, -1018.38,-249.5321,-532.6106,   14794,-557.3339, -372.8434,-363.1712,   -553.247,    -1186.068, -1023.16,-1253.360,  0,        0,-825.5032,   -491.6270,   -517.2930]'; 
     
    
else % Use data for solids
    a = [ 58.75340,    67.49796, 102.4290, 124.6550, 45.75120, 47.25995, 46.5065, 49.95403, -125.7730, 245.0104,   98.80851,     108.0564,  74.4752, 5.431501,  0, -20.8881, 150.6240,     47.4273,    48.55114]';
    b = [ 10.27925,    18.27015,  38.7498,-0.337045, 18.78553, 5.681621,   8.121, 4.887916,  302.0740,-567.0492,   0.308701,     10.39532,      0.0, 272.5617,  0, 157.3099,      0.0,     13.1362,    8.748034]';
    c = [-0.131384,   -11.25467,-15.91090, 5.705010,-5.952201,-0.872665,       0,-0.352056, -140.6420, 778.7219,   1.715663,     0.022966,      0.0,-252.4956,  0,        0,      0.0,   -3.796501,   -0.893966]'; 
    d = [ 0.025210,    2.371717, 2.628181,-1.053470, 0.852779, 0.104300,       0, 0.046187,  21.32400,-346.2641,  -0.145556,    -0.002862,      0.0, 97.65540,  0,        0,      0.0,    0.725398,    0.115057]'; 
    e = [ 0.025601,   -1.492815,-3.007551,-2.030501,-0.081265,-1.053955,-0.36837,-0.825097,  38.28310,-4.653361,  -14.90098,    -0.028030,      0.0,-0.377274,  0,   1.6284,      0.0,   -0.336757,   -0.507804]'; 
    f = [-929.3292,   -964.5919,-1717.930,-1178.440,-286.7429,-619.1316,       0,-652.9718, -301.6530,-432.8599,  -660.9507,    -1288.191,-1115.333,-1284.902,  0,        0,-875.6066,   -563.9310,   -608.6339]'; 
    g = [ 105.8092,    118.1658, 146.9970,  221.330, 110.3120, 76.46176,       0, 92.56096, -42.66700, 501.8708,   115.5893,     147.7006, 138.0247,-12.50564,  0,        0, 252.8814,    123.7920,    108.7489]'; 
    h = [-910.8568,    -938.722,-1675.690, 1134.700,-272.0441,-601.2408,   14794,-635.0894, -417.9820,-363.1712,  -598.7304,    -1225.912,-1097.463,-1271.936,  0,        0,-825.5032,   -548.1040,   -592.0360]'; 
    
    
end
    Cp_NIST = sum(a.*feed_mol_frac + b.*feed_mol_frac.*(T/1000) + c.*feed_mol_frac.*(T/1000)^2 + d.*feed_mol_frac.*(T/1000)^3 + e.*feed_mol_frac./((T/1000)^2));
    Del_H_NIST = sum(a.*feed_mol_frac)*(T/1000) + sum(b.*feed_mol_frac)*((T/1000)^2)/2 + sum(c.*feed_mol_frac)*((T/1000)^3)/3 + sum(d.*feed_mol_frac)*((T/1000)^4)/4 - sum(e.*feed_mol_frac)/(T/1000) + sum(f.*feed_mol_frac) - sum(h.*feed_mol_frac);

end
